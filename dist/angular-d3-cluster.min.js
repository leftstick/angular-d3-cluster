!function(t,e){"use strict";var a=function(a){var n={padding:1.5,clusterPadding:40,subjectRange:[30,45],arounderRange:[10,25],maxRadius:45,subjectFontSize:12,arounderFontSize:8},i={positive:"#FF0000",negative:"#00E700",white:"#fff"},r=function(t,e){return t&&"undefined"!=typeof t[e]?t[e]:n[e]},u=function(n){return{restrict:"A",scope:{option:"=",data:"="},link:function(u,o){function d(t){k.each(l(10*t.alpha*t.alpha)).each(s(.5)).attr("transform",function(t){return"translate("+t.x+", "+t.y+")"})}function l(t){return function(e){var a=j[e.cluster];if(a!==e){var n=e.x-a.x,i=e.y-a.y,r=Math.sqrt(n*n+i*i),u=e.radius+a.radius;r!=u&&(r=(r-u)/r*t,e.x-=n*=r,e.y-=i*=r,a.x+=n,a.y+=i)}}}function s(t){var e=a.geom.quadtree($);return function(a){var n=a.radius+v+Math.max(p,h),i=a.x-n,r=a.x+n,u=a.y-n,o=a.y+n;e.visit(function(e,n,d,l,s){if(e.point&&e.point!==a){var c=a.x-e.point.x,f=a.y-e.point.y,v=Math.sqrt(c*c+f*f),g=a.radius+e.point.radius+(a.cluster===e.point.cluster?p:h);g>v&&(v=(v-g)/v*t,a.x-=c*=v,a.y-=f*=v,e.point.x+=c,e.point.y+=f)}return n>r||i>l||d>o||u>s})}}var c,f,p,h,v,g,y,m,x,b,M,w,z,F,R,j,$,k,q=t.element(e),S=0,A=0,C=function(){for(j=[],$=[],c=o.prop("clientWidth"),f=o.prop("clientHeight"),p=r(u.option,"padding"),h=r(u.option,"clusterPadding"),v=r(u.option,"maxRadius"),g=r(u.option,"subjectRange"),y=r(u.option,"arounderRange"),m=r(u.option,"subjectFontSize"),x=r(u.option,"arounderFontSize"),S=0;S<u.data.length;S++)for((!b||b>Math.abs(u.data[S].value))&&(b=Math.abs(u.data[S].value)),(!M||M<Math.abs(u.data[S].value))&&(M=Math.abs(u.data[S].value)),A=0;A<u.data[S].children.length;A++)(!w||w>Math.abs(u.data[S].children[A].value))&&(w=Math.abs(u.data[S].children[A].value)),(!z||z<Math.abs(u.data[S].children[A].value))&&(z=Math.abs(u.data[S].children[A].value));for(F=a.scale.linear().domain([b,M]).range(g),R=a.scale.linear().domain([w,z]).range(y),S=0;S<u.data.length;S++){var t={cluster:S,radius:F(Math.abs(u.data[S].value)),name:u.data[S].name,value:u.data[S].value};for(j.push(t),$.push(t),A=0;A<u.data[S].children.length;A++){var e={cluster:S,radius:R(Math.abs(u.data[S].children[A].value)),name:u.data[S].children[A].name,value:u.data[S].children[A].value};$.push(e)}}var n=a.layout.force().nodes($).size([c,f]).gravity(.02).charge(-5).on("tick",d).start();o.find("svg").remove();var l=a.select(o[0]).append("svg").attr("width",c).attr("height",f);k=l.selectAll("g").data($).enter().append("g").call(n.drag),k.append("circle").attr("r",function(t){return t.radius}).style("fill",function(t){return j[t.cluster]===t?i.white:t.value>=0?i.positive:i.negative}).style("stroke",function(t){return t.value>=0?i.positive:i.negative}),k.append("text").text(function(t){return t.name}).attr({"alignment-baseline":"middle","text-anchor":"middle"}).style("font-size",function(t){return j[t.cluster]===t?m:x}).style("fill",function(t){return j[t.cluster]===t?t.value>=0?i.positive:i.negative:i.white}).style("display",function(t){return this.getComputedTextLength()>2*t.radius?"none":"block"})};C(),u.$watch("option",function(t,e){t&&e&&C()},!0),u.$watch("data",function(){C()},!0);var P=function(){n(function(){C()},1e3)};q.on("resize",P),u.$on("$destroy",function(){q.off("resize",P)})}}},o=t.module("angular-d3-cluster",[]);o.directive("ngCluster",["$timeout",u])};"object"==typeof exports?module.exports=a(require("d3")):"function"==typeof define&&define.amd?define(["d3"],a):a(e.d3)}(angular,window);
//# sourceMappingURL=angular-d3-cluster.min.js.map