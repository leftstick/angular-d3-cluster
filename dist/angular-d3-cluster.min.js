!function(t,e,a,n){"use strict";var i={padding:1.5,clusterPadding:40,subjectRange:[30,45],arounderRange:[10,25],maxRadius:45,subjectFontSize:12,arounderFontSize:8},r={positive:"#FF0000",negative:"#00E700",white:"#fff"},u=function(t,e){return t&&"undefined"!=typeof t[e]?t[e]:i[e]},o=function(a){return{restrict:"A",scope:{option:"=",data:"="},link:function(i,o){function d(t){k.each(l(10*t.alpha*t.alpha)).each(c(.5)).attr("transform",function(t){return"translate("+t.x+", "+t.y+")"})}function l(t){return function(e){var a=$[e.cluster];if(a!==e){var n=e.x-a.x,i=e.y-a.y,r=Math.sqrt(n*n+i*i),u=e.radius+a.radius;r!=u&&(r=(r-u)/r*t,e.x-=n*=r,e.y-=i*=r,a.x+=n,a.y+=i)}}}function c(t){var e=n.geom.quadtree(j);return function(a){var n=a.radius+h+Math.max(f,v),i=a.x-n,r=a.x+n,u=a.y-n,o=a.y+n;e.visit(function(e,n,d,l,c){if(e.point&&e.point!==a){var s=a.x-e.point.x,p=a.y-e.point.y,h=Math.sqrt(s*s+p*p),g=a.radius+e.point.radius+(a.cluster===e.point.cluster?f:v);g>h&&(h=(h-g)/h*t,a.x-=s*=h,a.y-=p*=h,e.point.x+=s,e.point.y+=p)}return n>r||i>l||d>o||u>c})}}var s,p,f,v,h,g,m,y,x,b,w,z,F,R,M,$,j,k,S=t.element(e),q=0,A=0,C=function(){for($=[],j=[],s=o.prop("clientWidth"),p=o.prop("clientHeight"),f=u(i.option,"padding"),v=u(i.option,"clusterPadding"),h=u(i.option,"maxRadius"),g=u(i.option,"subjectRange"),m=u(i.option,"arounderRange"),y=u(i.option,"subjectFontSize"),x=u(i.option,"arounderFontSize"),q=0;q<i.data.length;q++)for((!b||b>i.data[q].value)&&(b=i.data[q].value),(!w||w<i.data[q].value)&&(w=i.data[q].value),A=0;A<i.data[q].children.length;A++)(!z||z>i.data[q].children[A].value)&&(z=i.data[q].children[A].value),(!F||F<i.data[q].children[A].value)&&(F=i.data[q].children[A].value);for(R=n.scale.linear().domain([b,w]).range(g),M=n.scale.linear().domain([z,F]).range(m),q=0;q<i.data.length;q++){var t={cluster:q,radius:R(Math.abs(i.data[q].value)),name:i.data[q].name,value:i.data[q].value};for($.push(t),j.push(t),A=0;A<i.data[q].children.length;A++){var e={cluster:q,radius:M(Math.abs(i.data[q].children[A].value)),name:i.data[q].children[A].name,value:i.data[q].children[A].value};j.push(e)}}var a=n.layout.force().nodes(j).size([s,p]).gravity(.02).charge(-5).on("tick",d).start();o.find("svg").remove();var l=n.select(o[0]).append("svg").attr("width",s).attr("height",p);k=l.selectAll("g").data(j).enter().append("g").call(a.drag),k.append("circle").attr("r",function(t){return t.radius}).style("fill",function(t){return $[t.cluster]===t?r.white:t.value>=0?r.positive:r.negative}).style("stroke",function(t){return t.value>=0?r.positive:r.negative}),k.append("text").text(function(t){return t.name}).attr({"alignment-baseline":"middle","text-anchor":"middle"}).style("font-size",function(t){return $[t.cluster]===t?y:x}).style("fill",function(t){return $[t.cluster]===t?t.value>=0?r.positive:r.negative:r.white}).style("display",function(t){return this.getComputedTextLength()>2*t.radius?"none":"block"})};C(),i.$watch("option",function(t,e){t&&e&&C()},!0),i.$watch("data",function(){C()},!0);var P=function(){a(function(){C()},1e3)};S.on("resize",P),i.$on("$destroy",function(){S.off("resize",P)})}}},d=t.module("angular-d3-cluster",[]);d.directive("ngCluster",["$timeout",o])}(angular,window,document,d3);
//# sourceMappingURL=angular-d3-cluster.min.js.map