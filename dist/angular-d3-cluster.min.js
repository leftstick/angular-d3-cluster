!function(t,e){"use strict";var a=function(a){var n={padding:1.5,clusterPadding:40,subjectRange:[30,45],arounderRange:[10,25],maxRadius:45,subjectFontSize:12,arounderFontSize:8},i={positive:"#FF0000",negative:"#00E700",white:"#fff"},r=function(t,e){return t&&"undefined"!=typeof t[e]?t[e]:n[e]},u=function(n){return{restrict:"A",scope:{option:"=",data:"="},link:function(u,o){function d(t){$.each(l(10*t.alpha*t.alpha)).each(c(.5)).attr("transform",function(t){return"translate("+t.x+", "+t.y+")"})}function l(t){return function(e){var a=q[e.cluster];if(a!==e){var n=e.x-a.x,i=e.y-a.y,r=Math.sqrt(n*n+i*i),u=e.radius+a.radius;r!=u&&(r=(r-u)/r*t,e.x-=n*=r,e.y-=i*=r,a.x+=n,a.y+=i)}}}function c(t){var e=a.geom.quadtree(M);return function(a){var n=a.radius+h+Math.max(p,v),i=a.x-n,r=a.x+n,u=a.y-n,o=a.y+n;e.visit(function(e,n,d,l,c){if(e.point&&e.point!==a){var s=a.x-e.point.x,f=a.y-e.point.y,h=Math.sqrt(s*s+f*f),g=a.radius+e.point.radius+(a.cluster===e.point.cluster?p:v);g>h&&(h=(h-g)/h*t,a.x-=s*=h,a.y-=f*=h,e.point.x+=s,e.point.y+=f)}return n>r||i>l||d>o||u>c})}}var s,f,p,v,h,g,y,m,x,b,w,z,F,R,j,q,M,$,k=t.element(e),S=0,A=0,C=function(){for(q=[],M=[],s=o.prop("clientWidth"),f=o.prop("clientHeight"),p=r(u.option,"padding"),v=r(u.option,"clusterPadding"),h=r(u.option,"maxRadius"),g=r(u.option,"subjectRange"),y=r(u.option,"arounderRange"),m=r(u.option,"subjectFontSize"),x=r(u.option,"arounderFontSize"),S=0;S<u.data.length;S++)for((!b||b>u.data[S].value)&&(b=u.data[S].value),(!w||w<u.data[S].value)&&(w=u.data[S].value),A=0;A<u.data[S].children.length;A++)(!z||z>u.data[S].children[A].value)&&(z=u.data[S].children[A].value),(!F||F<u.data[S].children[A].value)&&(F=u.data[S].children[A].value);for(R=a.scale.linear().domain([b,w]).range(g),j=a.scale.linear().domain([z,F]).range(y),S=0;S<u.data.length;S++){var t={cluster:S,radius:R(Math.abs(u.data[S].value)),name:u.data[S].name,value:u.data[S].value};for(q.push(t),M.push(t),A=0;A<u.data[S].children.length;A++){var e={cluster:S,radius:j(Math.abs(u.data[S].children[A].value)),name:u.data[S].children[A].name,value:u.data[S].children[A].value};M.push(e)}}var n=a.layout.force().nodes(M).size([s,f]).gravity(.02).charge(-5).on("tick",d).start();o.find("svg").remove();var l=a.select(o[0]).append("svg").attr("width",s).attr("height",f);$=l.selectAll("g").data(M).enter().append("g").call(n.drag),$.append("circle").attr("r",function(t){return t.radius}).style("fill",function(t){return q[t.cluster]===t?i.white:t.value>=0?i.positive:i.negative}).style("stroke",function(t){return t.value>=0?i.positive:i.negative}),$.append("text").text(function(t){return t.name}).attr({"alignment-baseline":"middle","text-anchor":"middle"}).style("font-size",function(t){return q[t.cluster]===t?m:x}).style("fill",function(t){return q[t.cluster]===t?t.value>=0?i.positive:i.negative:i.white}).style("display",function(t){return this.getComputedTextLength()>2*t.radius?"none":"block"})};C(),u.$watch("option",function(t,e){t&&e&&C()},!0),u.$watch("data",function(){C()},!0);var P=function(){n(function(){C()},1e3)};k.on("resize",P),u.$on("$destroy",function(){k.off("resize",P)})}}},o=t.module("angular-d3-cluster",[]);o.directive("ngCluster",["$timeout",u])};"object"==typeof exports?a(require("d3")):"function"==typeof define&&define.amd?require(["d3"],a):a(e.d3)}(angular,window);
//# sourceMappingURL=angular-d3-cluster.min.js.map