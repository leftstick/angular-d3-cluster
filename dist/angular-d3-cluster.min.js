!function(t,e){"use strict";var n=function(n){var a={padding:1.5,clusterPadding:40,subjectRange:[30,45],arounderRange:[10,25],maxRadius:45,subjectFontSize:12,arounderFontSize:8},i={positive:"#FF0000",negative:"#00E700",white:"#fff"},r=function(t,e){return t&&"undefined"!=typeof t[e]?t[e]:a[e]},u=function(a){return{restrict:"A",scope:{option:"=",data:"="},link:function(u,o){function d(t){k.each(l(10*t.alpha*t.alpha)).each(c(.5)).attr("transform",function(t){return"translate("+t.x+", "+t.y+")"})}function l(t){return function(e){var n=M[e.cluster];if(n!==e){var a=e.x-n.x,i=e.y-n.y,r=Math.sqrt(a*a+i*i),u=e.radius+n.radius;r!=u&&(r=(r-u)/r*t,e.x-=a*=r,e.y-=i*=r,n.x+=a,n.y+=i)}}}function c(t){var e=n.geom.quadtree($);return function(n){var a=n.radius+h+Math.max(p,v),i=n.x-a,r=n.x+a,u=n.y-a,o=n.y+a;e.visit(function(e,a,d,l,c){if(e.point&&e.point!==n){var s=n.x-e.point.x,f=n.y-e.point.y,h=Math.sqrt(s*s+f*f),g=n.radius+e.point.radius+(n.cluster===e.point.cluster?p:v);g>h&&(h=(h-g)/h*t,n.x-=s*=h,n.y-=f*=h,e.point.x+=s,e.point.y+=f)}return a>r||i>l||d>o||u>c})}}var s,f,p,v,h,g,y,m,x,b,w,z,F,R,j,M,$,k,q=t.element(e),S=0,A=0,C=function(){for(M=[],$=[],s=o.prop("clientWidth"),f=o.prop("clientHeight"),p=r(u.option,"padding"),v=r(u.option,"clusterPadding"),h=r(u.option,"maxRadius"),g=r(u.option,"subjectRange"),y=r(u.option,"arounderRange"),m=r(u.option,"subjectFontSize"),x=r(u.option,"arounderFontSize"),S=0;S<u.data.length;S++)for((!b||b>u.data[S].value)&&(b=u.data[S].value),(!w||w<u.data[S].value)&&(w=u.data[S].value),A=0;A<u.data[S].children.length;A++)(!z||z>u.data[S].children[A].value)&&(z=u.data[S].children[A].value),(!F||F<u.data[S].children[A].value)&&(F=u.data[S].children[A].value);for(R=n.scale.linear().domain([b,w]).range(g),j=n.scale.linear().domain([z,F]).range(y),S=0;S<u.data.length;S++){var t={cluster:S,radius:R(Math.abs(u.data[S].value)),name:u.data[S].name,value:u.data[S].value};for(M.push(t),$.push(t),A=0;A<u.data[S].children.length;A++){var e={cluster:S,radius:j(Math.abs(u.data[S].children[A].value)),name:u.data[S].children[A].name,value:u.data[S].children[A].value};$.push(e)}}var a=n.layout.force().nodes($).size([s,f]).gravity(.02).charge(-5).on("tick",d).start();o.find("svg").remove();var l=n.select(o[0]).append("svg").attr("width",s).attr("height",f);k=l.selectAll("g").data($).enter().append("g").call(a.drag),k.append("circle").attr("r",function(t){return t.radius}).style("fill",function(t){return M[t.cluster]===t?i.white:t.value>=0?i.positive:i.negative}).style("stroke",function(t){return t.value>=0?i.positive:i.negative}),k.append("text").text(function(t){return t.name}).attr({"alignment-baseline":"middle","text-anchor":"middle"}).style("font-size",function(t){return M[t.cluster]===t?m:x}).style("fill",function(t){return M[t.cluster]===t?t.value>=0?i.positive:i.negative:i.white}).style("display",function(t){return this.getComputedTextLength()>2*t.radius?"none":"block"})};C(),u.$watch("option",function(t,e){t&&e&&C()},!0),u.$watch("data",function(){C()},!0);var P=function(){a(function(){C()},1e3)};q.on("resize",P),u.$on("$destroy",function(){q.off("resize",P)})}}},o=t.module("angular-d3-cluster",[]);o.directive("ngCluster",["$timeout",u])};"object"==typeof exports?module.exports=n(require("d3")):"function"==typeof define&&define.amd?define(["d3"],n):n(e.d3)}(angular,window);
//# sourceMappingURL=angular-d3-cluster.min.js.map